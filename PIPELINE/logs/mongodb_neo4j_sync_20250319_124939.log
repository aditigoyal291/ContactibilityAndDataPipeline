2025-03-19 12:49:39,317 - root - INFO - Starting MongoDB to Neo4j sync service
2025-03-19 12:49:39,318 - root - INFO - Sync interval: 5 minutes
2025-03-19 12:49:39,318 - root - INFO - Starting full sync job at 2025-03-19 12:49:39.318024
2025-03-19 12:49:45,198 - src.spark.session - INFO - Spark session created successfully
2025-03-19 12:49:45,315 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 12:49:45,329 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 12:49:45,330 - root - INFO - Extracting data from MongoDB...
2025-03-19 12:49:50,877 - src.etl.extract - INFO - Extracted 50 records from Person
2025-03-19 12:49:51,892 - src.etl.extract - INFO - Extracted 10 records from Company
2025-03-19 12:49:53,357 - src.etl.extract - INFO - Extracted 93 records from Loan
2025-03-19 12:49:54,374 - src.etl.extract - INFO - Extracted 57 records from PrimaryApplicant
2025-03-19 12:49:55,394 - src.etl.extract - INFO - Extracted 93 records from Coapplicant
2025-03-19 12:49:56,900 - src.etl.extract - INFO - Extracted 183 records from Reference
2025-03-19 12:49:56,907 - root - INFO - Loading nodes into Neo4j...
2025-03-19 12:50:00,915 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(0) already exists with label `Person` and property `personId` = 'PERSON001'
2025-03-19 12:50:02,163 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(1) already exists with label `Person` and property `personId` = 'PERSON002'
2025-03-19 12:50:03,324 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(2) already exists with label `Person` and property `personId` = 'PERSON003'
2025-03-19 12:50:04,427 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(3) already exists with label `Person` and property `personId` = 'PERSON004'
2025-03-19 12:50:05,599 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(4) already exists with label `Person` and property `personId` = 'PERSON005'
2025-03-19 12:50:06,742 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(5) already exists with label `Person` and property `personId` = 'PERSON006'
2025-03-19 12:50:07,924 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(6) already exists with label `Person` and property `personId` = 'PERSON007'
2025-03-19 12:50:09,065 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(7) already exists with label `Person` and property `personId` = 'PERSON008'
2025-03-19 12:50:10,232 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(8) already exists with label `Person` and property `personId` = 'PERSON009'
2025-03-19 12:50:11,357 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(9) already exists with label `Person` and property `personId` = 'PERSON010'
2025-03-19 12:50:12,594 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(10) already exists with label `Person` and property `personId` = 'PERSON011'
2025-03-19 12:50:13,702 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(11) already exists with label `Person` and property `personId` = 'PERSON012'
2025-03-19 12:50:14,830 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(12) already exists with label `Person` and property `personId` = 'PERSON013'
2025-03-19 12:50:15,961 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(13) already exists with label `Person` and property `personId` = 'PERSON014'
2025-03-19 12:50:17,075 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(14) already exists with label `Person` and property `personId` = 'PERSON015'
2025-03-19 12:50:18,149 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(15) already exists with label `Person` and property `personId` = 'PERSON016'
2025-03-19 12:50:19,170 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(16) already exists with label `Person` and property `personId` = 'PERSON017'
2025-03-19 12:50:20,333 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(17) already exists with label `Person` and property `personId` = 'PERSON018'
2025-03-19 12:50:21,452 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(18) already exists with label `Person` and property `personId` = 'PERSON019'
2025-03-19 12:50:22,553 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(19) already exists with label `Person` and property `personId` = 'PERSON020'
2025-03-19 12:50:23,560 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(20) already exists with label `Person` and property `personId` = 'PERSON021'
2025-03-19 12:50:24,600 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(21) already exists with label `Person` and property `personId` = 'PERSON022'
2025-03-19 12:50:25,670 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(22) already exists with label `Person` and property `personId` = 'PERSON023'
2025-03-19 12:50:26,710 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(23) already exists with label `Person` and property `personId` = 'PERSON024'
2025-03-19 12:50:27,766 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(24) already exists with label `Person` and property `personId` = 'PERSON025'
2025-03-19 12:50:28,817 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(25) already exists with label `Person` and property `personId` = 'PERSON026'
2025-03-19 12:50:29,917 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(26) already exists with label `Person` and property `personId` = 'PERSON027'
2025-03-19 12:50:30,980 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(27) already exists with label `Person` and property `personId` = 'PERSON028'
2025-03-19 12:50:31,988 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(28) already exists with label `Person` and property `personId` = 'PERSON029'
2025-03-19 12:50:33,064 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(29) already exists with label `Person` and property `personId` = 'PERSON030'
2025-03-19 12:50:34,055 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(30) already exists with label `Person` and property `personId` = 'PERSON031'
2025-03-19 12:50:35,149 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(31) already exists with label `Person` and property `personId` = 'PERSON032'
2025-03-19 12:50:36,157 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(32) already exists with label `Person` and property `personId` = 'PERSON033'
2025-03-19 12:50:37,163 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(33) already exists with label `Person` and property `personId` = 'PERSON034'
2025-03-19 12:50:38,166 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(34) already exists with label `Person` and property `personId` = 'PERSON035'
2025-03-19 12:50:39,195 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(35) already exists with label `Person` and property `personId` = 'PERSON036'
2025-03-19 12:50:40,160 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(36) already exists with label `Person` and property `personId` = 'PERSON037'
2025-03-19 12:50:41,317 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(37) already exists with label `Person` and property `personId` = 'PERSON038'
2025-03-19 12:50:42,340 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(38) already exists with label `Person` and property `personId` = 'PERSON039'
2025-03-19 12:50:43,412 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(39) already exists with label `Person` and property `personId` = 'PERSON040'
2025-03-19 12:50:44,447 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(40) already exists with label `Person` and property `personId` = 'PERSON041'
2025-03-19 12:50:45,427 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(41) already exists with label `Person` and property `personId` = 'PERSON042'
2025-03-19 12:50:46,421 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(42) already exists with label `Person` and property `personId` = 'PERSON043'
2025-03-19 12:50:47,412 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(43) already exists with label `Person` and property `personId` = 'PERSON044'
2025-03-19 12:50:48,600 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(44) already exists with label `Person` and property `personId` = 'PERSON045'
2025-03-19 12:50:49,698 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(45) already exists with label `Person` and property `personId` = 'PERSON046'
2025-03-19 12:50:50,753 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(46) already exists with label `Person` and property `personId` = 'PERSON047'
2025-03-19 12:50:51,925 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(47) already exists with label `Person` and property `personId` = 'PERSON048'
2025-03-19 12:50:52,987 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(48) already exists with label `Person` and property `personId` = 'PERSON049'
2025-03-19 12:50:54,016 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(49) already exists with label `Person` and property `personId` = 'PERSON050'
2025-03-19 12:50:54,017 - src.etl.load - INFO - Loaded 0 Person nodes
2025-03-19 12:50:55,633 - src.etl.load - INFO - Loaded 93 Loan nodes
2025-03-19 12:51:01,811 - src.spark.session - INFO - Updated sync timestamp for Loan to 2025-03-19T07:20:55.634896Z
2025-03-19 12:51:02,732 - src.etl.load - INFO - Loaded 10 Company nodes
2025-03-19 12:51:08,586 - src.spark.session - INFO - Updated sync timestamp for Company to 2025-03-19T07:21:02.732719Z
2025-03-19 12:51:08,587 - root - INFO - Loading relationships into Neo4j...
2025-03-19 12:51:13,050 - src.etl.load - INFO - Created 93 PrimaryApplicant-Loan relationships
2025-03-19 12:51:18,207 - src.spark.session - INFO - Updated sync timestamp for PrimaryApplicant to 2025-03-19T07:21:13.051978Z
2025-03-19 12:51:22,651 - src.etl.load - INFO - Created 93 Loan-CoApplicant relationships
2025-03-19 12:51:28,057 - src.spark.session - INFO - Updated sync timestamp for Coapplicant to 2025-03-19T07:21:22.651542Z
2025-03-19 12:51:32,773 - src.etl.load - INFO - Created 183 Loan-Reference relationships
2025-03-19 12:51:38,015 - src.spark.session - INFO - Updated sync timestamp for Reference to 2025-03-19T07:21:32.774852Z
2025-03-19 12:51:40,834 - src.etl.load - INFO - Created 50 Person-Company relationships
2025-03-19 12:51:40,835 - root - INFO - Sync job completed in 121.52 seconds
2025-03-19 12:51:40,835 - root - INFO - Nodes loaded: 0 Persons, 93 Loans, 10 Companies
2025-03-19 12:51:40,835 - root - INFO - Relationships loaded: 93 Primary, 93 CoApplicant, 183 Reference, 50 Company
2025-03-19 12:56:42,490 - root - INFO - Starting incremental sync job at 2025-03-19 12:56:42.490069
2025-03-19 12:56:43,361 - src.spark.session - INFO - Spark session created successfully
2025-03-19 12:56:43,363 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 12:56:43,370 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 12:56:43,371 - root - INFO - Extracting data from MongoDB...
2025-03-19 12:56:53,394 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 12:56:53,602 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#2944,aadhar#2945,address#2946,companyId#2947,dateOfBirth#2948,email#2949,income#2950,name#2951,pan#2952,personId#2953,phone#2954,position#2955,roles#2956,yearsEmployed#2957] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 12:57:02,439 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 12:57:02,462 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#2989,address#2990,companyId#2991,founded#2992,gst_number#2993,name#2994,phone#2995,sector#2996,website#2997] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 12:57:11,478 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 12:57:11,517 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#3024,amount#3025,applicationDate#3026,coapplicantId#3027,decisionDate#3028,interestRate#3029,loanId#3030,loanType#3031,primaryApplicantId#3032,references#3033,status#3034,term#3035] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 12:57:20,761 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 12:57:20,788 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#3065,isCoApplicantFor#3066,isReferenceFor#3067,loans#3068,name#3069,pan#3070,personId#3071,primaryApplicantId#3072] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 12:57:29,231 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 12:57:29,247 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#3098,coApplicantId#3099,linkedTo#3100,loanId#3101,name#3102,pan#3103,personId#3104,relationToPrimary#3105] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 12:57:35,624 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 12:57:35,654 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#3131,linkedTo#3132,loanId#3133,name#3134,pan#3135,personId#3136,referenceId#3137,relationToBorrower#3138,yearsKnown#3139] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 12:57:35,657 - root - INFO - Loading nodes into Neo4j...
2025-03-19 12:57:35,658 - src.etl.load - INFO - No Person data to load
2025-03-19 12:57:35,659 - src.etl.load - INFO - No Loan data to load
2025-03-19 12:57:35,659 - src.etl.load - INFO - No Company data to load
2025-03-19 12:57:35,660 - root - INFO - Loading relationships into Neo4j...
2025-03-19 12:57:35,660 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 12:57:35,661 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 12:57:35,661 - src.etl.load - INFO - No Reference data to load
2025-03-19 12:57:35,662 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 12:57:35,662 - root - INFO - Sync job completed in 53.17 seconds
2025-03-19 12:57:35,662 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 12:57:35,663 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:02:36,378 - root - INFO - Starting incremental sync job at 2025-03-19 13:02:36.378170
2025-03-19 13:02:37,199 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:02:37,206 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:02:37,216 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:02:37,216 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:02:45,473 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:02:45,493 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#3166,aadhar#3167,address#3168,companyId#3169,dateOfBirth#3170,email#3171,income#3172,name#3173,pan#3174,personId#3175,phone#3176,position#3177,roles#3178,yearsEmployed#3179] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:02:52,996 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:02:53,018 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#3211,address#3212,companyId#3213,founded#3214,gst_number#3215,name#3216,phone#3217,sector#3218,website#3219] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:02:59,416 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:02:59,442 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#3246,amount#3247,applicationDate#3248,coapplicantId#3249,decisionDate#3250,interestRate#3251,loanId#3252,loanType#3253,primaryApplicantId#3254,references#3255,status#3256,term#3257] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:03:06,737 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:03:06,772 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#3287,isCoApplicantFor#3288,isReferenceFor#3289,loans#3290,name#3291,pan#3292,personId#3293,primaryApplicantId#3294] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:03:14,182 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:03:14,211 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#3320,coApplicantId#3321,linkedTo#3322,loanId#3323,name#3324,pan#3325,personId#3326,relationToPrimary#3327] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:03:21,068 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:03:21,104 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#3353,linkedTo#3354,loanId#3355,name#3356,pan#3357,personId#3358,referenceId#3359,relationToBorrower#3360,yearsKnown#3361] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:03:21,106 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:03:21,106 - src.etl.load - INFO - No Person data to load
2025-03-19 13:03:21,107 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:03:21,107 - src.etl.load - INFO - No Company data to load
2025-03-19 13:03:21,107 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:03:21,108 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:03:21,108 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:03:21,109 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:03:21,109 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:03:21,110 - root - INFO - Sync job completed in 44.73 seconds
2025-03-19 13:03:21,111 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:03:21,111 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:08:21,908 - root - INFO - Starting incremental sync job at 2025-03-19 13:08:21.908141
2025-03-19 13:08:22,677 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:08:22,681 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:08:22,693 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:08:22,694 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:08:30,741 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:08:30,775 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#3388,aadhar#3389,address#3390,companyId#3391,dateOfBirth#3392,email#3393,income#3394,name#3395,pan#3396,personId#3397,phone#3398,position#3399,roles#3400,yearsEmployed#3401] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:08:37,894 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:08:37,923 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#3433,address#3434,companyId#3435,founded#3436,gst_number#3437,name#3438,phone#3439,sector#3440,website#3441] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:08:44,937 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:08:44,980 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#3468,amount#3469,applicationDate#3470,coapplicantId#3471,decisionDate#3472,interestRate#3473,loanId#3474,loanType#3475,primaryApplicantId#3476,references#3477,status#3478,term#3479] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:08:51,243 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:08:51,287 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#3509,isCoApplicantFor#3510,isReferenceFor#3511,loans#3512,name#3513,pan#3514,personId#3515,primaryApplicantId#3516] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:08:58,675 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:08:58,716 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#3542,coApplicantId#3543,linkedTo#3544,loanId#3545,name#3546,pan#3547,personId#3548,relationToPrimary#3549] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:09:05,492 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:09:05,518 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#3575,linkedTo#3576,loanId#3577,name#3578,pan#3579,personId#3580,referenceId#3581,relationToBorrower#3582,yearsKnown#3583] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:09:05,520 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:09:05,521 - src.etl.load - INFO - No Person data to load
2025-03-19 13:09:05,521 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:09:05,521 - src.etl.load - INFO - No Company data to load
2025-03-19 13:09:05,522 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:09:05,522 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:09:05,522 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:09:05,523 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:09:05,523 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:09:05,523 - root - INFO - Sync job completed in 43.62 seconds
2025-03-19 13:09:05,523 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:09:05,524 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:14:06,576 - root - INFO - Starting incremental sync job at 2025-03-19 13:14:06.576724
2025-03-19 13:14:07,361 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:14:07,365 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:14:07,374 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:14:07,374 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:14:14,821 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:14:14,860 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#3610,aadhar#3611,address#3612,companyId#3613,dateOfBirth#3614,email#3615,income#3616,name#3617,pan#3618,personId#3619,phone#3620,position#3621,roles#3622,yearsEmployed#3623] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:14:21,445 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:14:21,477 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#3655,address#3656,companyId#3657,founded#3658,gst_number#3659,name#3660,phone#3661,sector#3662,website#3663] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:14:28,347 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:14:28,392 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#3690,amount#3691,applicationDate#3692,coapplicantId#3693,decisionDate#3694,interestRate#3695,loanId#3696,loanType#3697,primaryApplicantId#3698,references#3699,status#3700,term#3701] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:14:34,424 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:14:34,467 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#3731,isCoApplicantFor#3732,isReferenceFor#3733,loans#3734,name#3735,pan#3736,personId#3737,primaryApplicantId#3738] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:14:41,588 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:14:41,623 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#3764,coApplicantId#3765,linkedTo#3766,loanId#3767,name#3768,pan#3769,personId#3770,relationToPrimary#3771] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:14:48,128 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:14:48,163 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#3797,linkedTo#3798,loanId#3799,name#3800,pan#3801,personId#3802,referenceId#3803,relationToBorrower#3804,yearsKnown#3805] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:14:48,166 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:14:48,166 - src.etl.load - INFO - No Person data to load
2025-03-19 13:14:48,167 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:14:48,168 - src.etl.load - INFO - No Company data to load
2025-03-19 13:14:48,168 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:14:48,169 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:14:48,170 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:14:48,170 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:14:48,171 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:14:48,172 - root - INFO - Sync job completed in 41.60 seconds
2025-03-19 13:14:48,173 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:14:48,173 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:19:49,172 - root - INFO - Starting incremental sync job at 2025-03-19 13:19:49.172739
2025-03-19 13:19:50,007 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:19:50,011 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:19:50,028 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:19:50,028 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:19:59,184 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:19:59,226 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#3832,aadhar#3833,address#3834,companyId#3835,dateOfBirth#3836,email#3837,income#3838,name#3839,pan#3840,personId#3841,phone#3842,position#3843,roles#3844,yearsEmployed#3845] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:20:05,888 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:20:05,905 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#3877,address#3878,companyId#3879,founded#3880,gst_number#3881,name#3882,phone#3883,sector#3884,website#3885] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:20:13,180 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:20:13,219 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#3912,amount#3913,applicationDate#3914,coapplicantId#3915,decisionDate#3916,interestRate#3917,loanId#3918,loanType#3919,primaryApplicantId#3920,references#3921,status#3922,term#3923] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:20:20,188 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:20:20,224 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#3953,isCoApplicantFor#3954,isReferenceFor#3955,loans#3956,name#3957,pan#3958,personId#3959,primaryApplicantId#3960] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:20:29,214 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:20:29,256 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#3986,coApplicantId#3987,linkedTo#3988,loanId#3989,name#3990,pan#3991,personId#3992,relationToPrimary#3993] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:20:36,202 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:20:36,222 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#4019,linkedTo#4020,loanId#4021,name#4022,pan#4023,personId#4024,referenceId#4025,relationToBorrower#4026,yearsKnown#4027] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:20:36,223 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:20:36,223 - src.etl.load - INFO - No Person data to load
2025-03-19 13:20:36,223 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:20:36,223 - src.etl.load - INFO - No Company data to load
2025-03-19 13:20:36,223 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:20:36,223 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:20:36,225 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:20:36,225 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:20:36,225 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:20:36,225 - root - INFO - Sync job completed in 47.05 seconds
2025-03-19 13:20:36,225 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:20:36,225 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:25:37,015 - root - INFO - Starting incremental sync job at 2025-03-19 13:25:37.015954
2025-03-19 13:25:37,910 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:25:37,914 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:25:37,925 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:25:37,926 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:25:45,782 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:25:45,819 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#4054,aadhar#4055,address#4056,companyId#4057,dateOfBirth#4058,email#4059,income#4060,name#4061,pan#4062,personId#4063,phone#4064,position#4065,roles#4066,yearsEmployed#4067] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:25:52,681 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:25:52,714 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#4099,address#4100,companyId#4101,founded#4102,gst_number#4103,name#4104,phone#4105,sector#4106,website#4107] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:25:59,140 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:25:59,181 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#4134,amount#4135,applicationDate#4136,coapplicantId#4137,decisionDate#4138,interestRate#4139,loanId#4140,loanType#4141,primaryApplicantId#4142,references#4143,status#4144,term#4145] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:26:05,886 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:26:05,922 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#4175,isCoApplicantFor#4176,isReferenceFor#4177,loans#4178,name#4179,pan#4180,personId#4181,primaryApplicantId#4182] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:26:12,232 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:26:12,255 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#4208,coApplicantId#4209,linkedTo#4210,loanId#4211,name#4212,pan#4213,personId#4214,relationToPrimary#4215] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:26:18,805 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:26:18,840 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#4241,linkedTo#4242,loanId#4243,name#4244,pan#4245,personId#4246,referenceId#4247,relationToBorrower#4248,yearsKnown#4249] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:26:18,843 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:26:18,844 - src.etl.load - INFO - No Person data to load
2025-03-19 13:26:18,844 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:26:18,846 - src.etl.load - INFO - No Company data to load
2025-03-19 13:26:18,846 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:26:18,846 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:26:18,846 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:26:18,846 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:26:18,847 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:26:18,847 - root - INFO - Sync job completed in 41.83 seconds
2025-03-19 13:26:18,849 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:26:18,850 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:31:19,704 - root - INFO - Starting incremental sync job at 2025-03-19 13:31:19.704121
2025-03-19 13:31:20,533 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:31:20,536 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:31:20,544 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:31:20,544 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:31:27,705 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:31:27,732 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#4276,aadhar#4277,address#4278,companyId#4279,dateOfBirth#4280,email#4281,income#4282,name#4283,pan#4284,personId#4285,phone#4286,position#4287,roles#4288,yearsEmployed#4289] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:31:35,223 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:31:35,250 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#4321,address#4322,companyId#4323,founded#4324,gst_number#4325,name#4326,phone#4327,sector#4328,website#4329] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:31:42,024 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:31:42,048 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#4356,amount#4357,applicationDate#4358,coapplicantId#4359,decisionDate#4360,interestRate#4361,loanId#4362,loanType#4363,primaryApplicantId#4364,references#4365,status#4366,term#4367] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:31:49,044 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:31:49,064 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#4397,isCoApplicantFor#4398,isReferenceFor#4399,loans#4400,name#4401,pan#4402,personId#4403,primaryApplicantId#4404] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:31:56,433 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:31:56,467 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#4430,coApplicantId#4431,linkedTo#4432,loanId#4433,name#4434,pan#4435,personId#4436,relationToPrimary#4437] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:32:03,915 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:32:03,960 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#4463,linkedTo#4464,loanId#4465,name#4466,pan#4467,personId#4468,referenceId#4469,relationToBorrower#4470,yearsKnown#4471] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:32:03,962 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:32:03,962 - src.etl.load - INFO - No Person data to load
2025-03-19 13:32:03,963 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:32:03,963 - src.etl.load - INFO - No Company data to load
2025-03-19 13:32:03,964 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:32:03,964 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:32:03,964 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:32:03,964 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:32:03,965 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:32:03,965 - root - INFO - Sync job completed in 44.26 seconds
2025-03-19 13:32:03,965 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:32:03,966 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:37:04,957 - root - INFO - Starting incremental sync job at 2025-03-19 13:37:04.957336
2025-03-19 13:37:05,675 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:37:05,679 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:37:05,683 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:37:05,684 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:37:12,414 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:37:12,432 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#4498,aadhar#4499,address#4500,companyId#4501,dateOfBirth#4502,email#4503,income#4504,name#4505,pan#4506,personId#4507,phone#4508,position#4509,roles#4510,yearsEmployed#4511] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:37:19,794 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:37:19,819 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#4543,address#4544,companyId#4545,founded#4546,gst_number#4547,name#4548,phone#4549,sector#4550,website#4551] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:37:25,890 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:37:25,908 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#4578,amount#4579,applicationDate#4580,coapplicantId#4581,decisionDate#4582,interestRate#4583,loanId#4584,loanType#4585,primaryApplicantId#4586,references#4587,status#4588,term#4589] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:37:31,604 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:37:31,622 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#4619,isCoApplicantFor#4620,isReferenceFor#4621,loans#4622,name#4623,pan#4624,personId#4625,primaryApplicantId#4626] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:37:37,257 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:37:37,276 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#4652,coApplicantId#4653,linkedTo#4654,loanId#4655,name#4656,pan#4657,personId#4658,relationToPrimary#4659] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:37:43,138 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:37:43,156 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#4685,linkedTo#4686,loanId#4687,name#4688,pan#4689,personId#4690,referenceId#4691,relationToBorrower#4692,yearsKnown#4693] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:37:43,158 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:37:43,159 - src.etl.load - INFO - No Person data to load
2025-03-19 13:37:43,159 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:37:43,159 - src.etl.load - INFO - No Company data to load
2025-03-19 13:37:43,159 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:37:43,159 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:37:43,160 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:37:43,160 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:37:43,160 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:37:43,160 - root - INFO - Sync job completed in 38.20 seconds
2025-03-19 13:37:43,160 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:37:43,160 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:42:43,981 - root - INFO - Starting incremental sync job at 2025-03-19 13:42:43.981383
2025-03-19 13:42:44,726 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:42:44,730 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:42:44,736 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:42:44,736 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:42:51,237 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:42:51,250 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#4720,aadhar#4721,address#4722,companyId#4723,dateOfBirth#4724,email#4725,income#4726,name#4727,pan#4728,personId#4729,phone#4730,position#4731,roles#4732,yearsEmployed#4733] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:42:57,104 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:42:57,121 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#4765,address#4766,companyId#4767,founded#4768,gst_number#4769,name#4770,phone#4771,sector#4772,website#4773] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:43:06,326 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:43:06,345 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#4800,amount#4801,applicationDate#4802,coapplicantId#4803,decisionDate#4804,interestRate#4805,loanId#4806,loanType#4807,primaryApplicantId#4808,references#4809,status#4810,term#4811] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:43:13,608 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:43:13,625 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#4841,isCoApplicantFor#4842,isReferenceFor#4843,loans#4844,name#4845,pan#4846,personId#4847,primaryApplicantId#4848] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:43:19,400 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:43:19,420 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#4874,coApplicantId#4875,linkedTo#4876,loanId#4877,name#4878,pan#4879,personId#4880,relationToPrimary#4881] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:43:24,792 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:43:24,810 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#4907,linkedTo#4908,loanId#4909,name#4910,pan#4911,personId#4912,referenceId#4913,relationToBorrower#4914,yearsKnown#4915] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:43:24,812 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:43:24,812 - src.etl.load - INFO - No Person data to load
2025-03-19 13:43:24,812 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:43:24,812 - src.etl.load - INFO - No Company data to load
2025-03-19 13:43:24,813 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:43:24,813 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:43:24,813 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:43:24,813 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:43:24,813 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:43:24,813 - root - INFO - Sync job completed in 40.83 seconds
2025-03-19 13:43:24,814 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:43:24,814 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:48:25,673 - root - INFO - Starting incremental sync job at 2025-03-19 13:48:25.673881
2025-03-19 13:48:26,363 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:48:26,367 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:48:26,377 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:48:26,378 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:48:33,223 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:48:33,237 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#4942,aadhar#4943,address#4944,companyId#4945,dateOfBirth#4946,email#4947,income#4948,name#4949,pan#4950,personId#4951,phone#4952,position#4953,roles#4954,yearsEmployed#4955] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:48:39,308 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:48:39,325 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#4987,address#4988,companyId#4989,founded#4990,gst_number#4991,name#4992,phone#4993,sector#4994,website#4995] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:48:45,223 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:48:45,243 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#5022,amount#5023,applicationDate#5024,coapplicantId#5025,decisionDate#5026,interestRate#5027,loanId#5028,loanType#5029,primaryApplicantId#5030,references#5031,status#5032,term#5033] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:48:51,639 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:48:51,660 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#5063,isCoApplicantFor#5064,isReferenceFor#5065,loans#5066,name#5067,pan#5068,personId#5069,primaryApplicantId#5070] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:48:57,659 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:48:57,676 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#5096,coApplicantId#5097,linkedTo#5098,loanId#5099,name#5100,pan#5101,personId#5102,relationToPrimary#5103] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:49:05,852 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:49:05,871 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#5129,linkedTo#5130,loanId#5131,name#5132,pan#5133,personId#5134,referenceId#5135,relationToBorrower#5136,yearsKnown#5137] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:49:05,872 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:49:05,872 - src.etl.load - INFO - No Person data to load
2025-03-19 13:49:05,873 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:49:05,873 - src.etl.load - INFO - No Company data to load
2025-03-19 13:49:05,873 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:49:05,873 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:49:05,874 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:49:05,874 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:49:05,874 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:49:05,874 - root - INFO - Sync job completed in 40.20 seconds
2025-03-19 13:49:05,875 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:49:05,875 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:54:06,881 - root - INFO - Starting incremental sync job at 2025-03-19 13:54:06.881653
2025-03-19 13:54:07,594 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:54:07,598 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:54:07,604 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:54:07,604 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:54:14,394 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:54:14,409 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#5164,aadhar#5165,address#5166,companyId#5167,dateOfBirth#5168,email#5169,income#5170,name#5171,pan#5172,personId#5173,phone#5174,position#5175,roles#5176,yearsEmployed#5177] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:54:20,689 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:54:20,700 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#5209,address#5210,companyId#5211,founded#5212,gst_number#5213,name#5214,phone#5215,sector#5216,website#5217] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 13:54:26,949 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 13:54:26,969 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#5244,amount#5245,applicationDate#5246,coapplicantId#5247,decisionDate#5248,interestRate#5249,loanId#5250,loanType#5251,primaryApplicantId#5252,references#5253,status#5254,term#5255] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 13:54:33,138 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 13:54:33,158 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#5285,isCoApplicantFor#5286,isReferenceFor#5287,loans#5288,name#5289,pan#5290,personId#5291,primaryApplicantId#5292] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 13:54:38,585 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 13:54:38,606 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#5318,coApplicantId#5319,linkedTo#5320,loanId#5321,name#5322,pan#5323,personId#5324,relationToPrimary#5325] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 13:54:44,584 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 13:54:44,601 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#5351,linkedTo#5352,loanId#5353,name#5354,pan#5355,personId#5356,referenceId#5357,relationToBorrower#5358,yearsKnown#5359] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 13:54:44,603 - root - INFO - Loading nodes into Neo4j...
2025-03-19 13:54:44,603 - src.etl.load - INFO - No Person data to load
2025-03-19 13:54:44,603 - src.etl.load - INFO - No Loan data to load
2025-03-19 13:54:44,603 - src.etl.load - INFO - No Company data to load
2025-03-19 13:54:44,603 - root - INFO - Loading relationships into Neo4j...
2025-03-19 13:54:44,604 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 13:54:44,604 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 13:54:44,604 - src.etl.load - INFO - No Reference data to load
2025-03-19 13:54:44,604 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 13:54:44,604 - root - INFO - Sync job completed in 37.72 seconds
2025-03-19 13:54:44,604 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 13:54:44,604 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 13:59:45,546 - root - INFO - Starting incremental sync job at 2025-03-19 13:59:45.546377
2025-03-19 13:59:46,248 - src.spark.session - INFO - Spark session created successfully
2025-03-19 13:59:46,251 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 13:59:46,258 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 13:59:46,258 - root - INFO - Extracting data from MongoDB...
2025-03-19 13:59:53,136 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 13:59:53,155 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#5386,aadhar#5387,address#5388,companyId#5389,dateOfBirth#5390,email#5391,income#5392,name#5393,pan#5394,personId#5395,phone#5396,position#5397,roles#5398,yearsEmployed#5399] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 13:59:59,257 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 13:59:59,273 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#5431,address#5432,companyId#5433,founded#5434,gst_number#5435,name#5436,phone#5437,sector#5438,website#5439] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:00:05,394 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:00:05,414 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#5466,amount#5467,applicationDate#5468,coapplicantId#5469,decisionDate#5470,interestRate#5471,loanId#5472,loanType#5473,primaryApplicantId#5474,references#5475,status#5476,term#5477] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:00:11,350 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:00:11,370 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#5507,isCoApplicantFor#5508,isReferenceFor#5509,loans#5510,name#5511,pan#5512,personId#5513,primaryApplicantId#5514] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:00:17,090 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:00:17,114 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#5540,coApplicantId#5541,linkedTo#5542,loanId#5543,name#5544,pan#5545,personId#5546,relationToPrimary#5547] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:00:22,986 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:00:22,999 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#5573,linkedTo#5574,loanId#5575,name#5576,pan#5577,personId#5578,referenceId#5579,relationToBorrower#5580,yearsKnown#5581] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:00:23,000 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:00:23,001 - src.etl.load - INFO - No Person data to load
2025-03-19 14:00:23,001 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:00:23,001 - src.etl.load - INFO - No Company data to load
2025-03-19 14:00:23,001 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:00:23,001 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:00:23,001 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:00:23,001 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:00:23,002 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:00:23,002 - root - INFO - Sync job completed in 37.46 seconds
2025-03-19 14:00:23,002 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:00:23,002 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:05:24,080 - root - INFO - Starting incremental sync job at 2025-03-19 14:05:24.080691
2025-03-19 14:05:24,815 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:05:24,817 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:05:24,822 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:05:24,822 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:05:31,281 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:05:31,291 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#5608,aadhar#5609,address#5610,companyId#5611,dateOfBirth#5612,email#5613,income#5614,name#5615,pan#5616,personId#5617,phone#5618,position#5619,roles#5620,yearsEmployed#5621] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:05:37,108 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:05:37,125 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#5653,address#5654,companyId#5655,founded#5656,gst_number#5657,name#5658,phone#5659,sector#5660,website#5661] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:05:43,087 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:05:43,100 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#5688,amount#5689,applicationDate#5690,coapplicantId#5691,decisionDate#5692,interestRate#5693,loanId#5694,loanType#5695,primaryApplicantId#5696,references#5697,status#5698,term#5699] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:05:49,201 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:05:49,223 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#5729,isCoApplicantFor#5730,isReferenceFor#5731,loans#5732,name#5733,pan#5734,personId#5735,primaryApplicantId#5736] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:05:55,500 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:05:55,517 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#5762,coApplicantId#5763,linkedTo#5764,loanId#5765,name#5766,pan#5767,personId#5768,relationToPrimary#5769] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:06:01,315 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:06:01,338 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#5795,linkedTo#5796,loanId#5797,name#5798,pan#5799,personId#5800,referenceId#5801,relationToBorrower#5802,yearsKnown#5803] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:06:01,340 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:06:01,340 - src.etl.load - INFO - No Person data to load
2025-03-19 14:06:01,341 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:06:01,341 - src.etl.load - INFO - No Company data to load
2025-03-19 14:06:01,341 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:06:01,341 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:06:01,342 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:06:01,342 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:06:01,342 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:06:01,342 - root - INFO - Sync job completed in 37.26 seconds
2025-03-19 14:06:01,342 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:06:01,342 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:11:02,124 - root - INFO - Starting incremental sync job at 2025-03-19 14:11:02.124469
2025-03-19 14:11:02,867 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:11:02,870 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:11:02,877 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:11:02,878 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:11:09,332 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:11:09,342 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#5830,aadhar#5831,address#5832,companyId#5833,dateOfBirth#5834,email#5835,income#5836,name#5837,pan#5838,personId#5839,phone#5840,position#5841,roles#5842,yearsEmployed#5843] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:11:15,835 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:11:15,853 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#5875,address#5876,companyId#5877,founded#5878,gst_number#5879,name#5880,phone#5881,sector#5882,website#5883] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:11:21,733 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:11:21,751 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#5910,amount#5911,applicationDate#5912,coapplicantId#5913,decisionDate#5914,interestRate#5915,loanId#5916,loanType#5917,primaryApplicantId#5918,references#5919,status#5920,term#5921] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:11:27,940 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:11:27,960 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#5951,isCoApplicantFor#5952,isReferenceFor#5953,loans#5954,name#5955,pan#5956,personId#5957,primaryApplicantId#5958] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:11:33,752 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:11:33,768 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#5984,coApplicantId#5985,linkedTo#5986,loanId#5987,name#5988,pan#5989,personId#5990,relationToPrimary#5991] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:11:39,615 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:11:39,637 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#6017,linkedTo#6018,loanId#6019,name#6020,pan#6021,personId#6022,referenceId#6023,relationToBorrower#6024,yearsKnown#6025] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:11:39,638 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:11:39,639 - src.etl.load - INFO - No Person data to load
2025-03-19 14:11:39,639 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:11:39,639 - src.etl.load - INFO - No Company data to load
2025-03-19 14:11:39,640 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:11:39,640 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:11:39,640 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:11:39,640 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:11:39,640 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:11:39,641 - root - INFO - Sync job completed in 37.52 seconds
2025-03-19 14:11:39,641 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:11:39,641 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:16:40,797 - root - INFO - Starting incremental sync job at 2025-03-19 14:16:40.797483
2025-03-19 14:16:41,535 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:16:41,537 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:16:41,542 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:16:41,542 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:16:48,245 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:16:48,256 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#6052,aadhar#6053,address#6054,companyId#6055,dateOfBirth#6056,email#6057,income#6058,name#6059,pan#6060,personId#6061,phone#6062,position#6063,roles#6064,yearsEmployed#6065] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:16:54,390 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:16:54,409 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#6097,address#6098,companyId#6099,founded#6100,gst_number#6101,name#6102,phone#6103,sector#6104,website#6105] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:17:00,507 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:17:00,529 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#6132,amount#6133,applicationDate#6134,coapplicantId#6135,decisionDate#6136,interestRate#6137,loanId#6138,loanType#6139,primaryApplicantId#6140,references#6141,status#6142,term#6143] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:17:06,279 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:17:06,300 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#6173,isCoApplicantFor#6174,isReferenceFor#6175,loans#6176,name#6177,pan#6178,personId#6179,primaryApplicantId#6180] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:17:12,061 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:17:12,072 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#6206,coApplicantId#6207,linkedTo#6208,loanId#6209,name#6210,pan#6211,personId#6212,relationToPrimary#6213] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:17:17,644 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:17:17,662 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#6239,linkedTo#6240,loanId#6241,name#6242,pan#6243,personId#6244,referenceId#6245,relationToBorrower#6246,yearsKnown#6247] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:17:17,663 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:17:17,664 - src.etl.load - INFO - No Person data to load
2025-03-19 14:17:17,664 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:17:17,664 - src.etl.load - INFO - No Company data to load
2025-03-19 14:17:17,664 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:17:17,664 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:17:17,665 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:17:17,665 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:17:17,665 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:17:17,665 - root - INFO - Sync job completed in 36.87 seconds
2025-03-19 14:17:17,665 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:17:17,665 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:22:18,790 - root - INFO - Starting incremental sync job at 2025-03-19 14:22:18.790682
2025-03-19 14:22:19,518 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:22:19,522 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:22:19,528 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:22:19,529 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:22:26,151 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:22:26,160 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#6274,aadhar#6275,address#6276,companyId#6277,dateOfBirth#6278,email#6279,income#6280,name#6281,pan#6282,personId#6283,phone#6284,position#6285,roles#6286,yearsEmployed#6287] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:22:32,438 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:22:32,452 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#6319,address#6320,companyId#6321,founded#6322,gst_number#6323,name#6324,phone#6325,sector#6326,website#6327] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:22:38,548 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:22:38,570 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#6354,amount#6355,applicationDate#6356,coapplicantId#6357,decisionDate#6358,interestRate#6359,loanId#6360,loanType#6361,primaryApplicantId#6362,references#6363,status#6364,term#6365] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:22:44,471 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:22:44,489 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#6395,isCoApplicantFor#6396,isReferenceFor#6397,loans#6398,name#6399,pan#6400,personId#6401,primaryApplicantId#6402] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:22:49,885 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:22:49,903 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#6428,coApplicantId#6429,linkedTo#6430,loanId#6431,name#6432,pan#6433,personId#6434,relationToPrimary#6435] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:22:55,916 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:22:55,933 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#6461,linkedTo#6462,loanId#6463,name#6464,pan#6465,personId#6466,referenceId#6467,relationToBorrower#6468,yearsKnown#6469] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:22:55,934 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:22:55,934 - src.etl.load - INFO - No Person data to load
2025-03-19 14:22:55,934 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:22:55,934 - src.etl.load - INFO - No Company data to load
2025-03-19 14:22:55,934 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:22:55,934 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:22:55,934 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:22:55,934 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:22:55,936 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:22:55,936 - root - INFO - Sync job completed in 37.15 seconds
2025-03-19 14:22:55,936 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:22:55,936 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:27:56,860 - root - INFO - Starting incremental sync job at 2025-03-19 14:27:56.860555
2025-03-19 14:27:57,579 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:27:57,582 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:27:57,588 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:27:57,588 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:28:03,929 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:28:03,948 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#6496,aadhar#6497,address#6498,companyId#6499,dateOfBirth#6500,email#6501,income#6502,name#6503,pan#6504,personId#6505,phone#6506,position#6507,roles#6508,yearsEmployed#6509] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:28:10,236 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:28:10,257 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#6541,address#6542,companyId#6543,founded#6544,gst_number#6545,name#6546,phone#6547,sector#6548,website#6549] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:28:15,939 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:28:15,960 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#6576,amount#6577,applicationDate#6578,coapplicantId#6579,decisionDate#6580,interestRate#6581,loanId#6582,loanType#6583,primaryApplicantId#6584,references#6585,status#6586,term#6587] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:28:21,128 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:28:21,147 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#6617,isCoApplicantFor#6618,isReferenceFor#6619,loans#6620,name#6621,pan#6622,personId#6623,primaryApplicantId#6624] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:28:26,934 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:28:26,949 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#6650,coApplicantId#6651,linkedTo#6652,loanId#6653,name#6654,pan#6655,personId#6656,relationToPrimary#6657] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:28:32,445 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:28:32,465 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#6683,linkedTo#6684,loanId#6685,name#6686,pan#6687,personId#6688,referenceId#6689,relationToBorrower#6690,yearsKnown#6691] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:28:32,468 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:28:32,468 - src.etl.load - INFO - No Person data to load
2025-03-19 14:28:32,468 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:28:32,468 - src.etl.load - INFO - No Company data to load
2025-03-19 14:28:32,469 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:28:32,469 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:28:32,469 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:28:32,469 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:28:32,469 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:28:32,470 - root - INFO - Sync job completed in 35.61 seconds
2025-03-19 14:28:32,470 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:28:32,470 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:33:33,417 - root - INFO - Starting incremental sync job at 2025-03-19 14:33:33.417112
2025-03-19 14:33:34,131 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:33:34,134 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:33:34,138 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:33:34,138 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:33:40,712 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:33:40,731 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#6718,aadhar#6719,address#6720,companyId#6721,dateOfBirth#6722,email#6723,income#6724,name#6725,pan#6726,personId#6727,phone#6728,position#6729,roles#6730,yearsEmployed#6731] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:33:46,743 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:33:46,758 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#6763,address#6764,companyId#6765,founded#6766,gst_number#6767,name#6768,phone#6769,sector#6770,website#6771] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:33:52,643 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:33:52,665 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#6798,amount#6799,applicationDate#6800,coapplicantId#6801,decisionDate#6802,interestRate#6803,loanId#6804,loanType#6805,primaryApplicantId#6806,references#6807,status#6808,term#6809] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:33:58,725 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:33:58,741 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#6839,isCoApplicantFor#6840,isReferenceFor#6841,loans#6842,name#6843,pan#6844,personId#6845,primaryApplicantId#6846] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:34:04,503 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:34:04,514 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#6872,coApplicantId#6873,linkedTo#6874,loanId#6875,name#6876,pan#6877,personId#6878,relationToPrimary#6879] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:34:10,271 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:34:10,295 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#6905,linkedTo#6906,loanId#6907,name#6908,pan#6909,personId#6910,referenceId#6911,relationToBorrower#6912,yearsKnown#6913] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:34:10,296 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:34:10,297 - src.etl.load - INFO - No Person data to load
2025-03-19 14:34:10,297 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:34:10,297 - src.etl.load - INFO - No Company data to load
2025-03-19 14:34:10,297 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:34:10,297 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:34:10,298 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:34:10,298 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:34:10,298 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:34:10,298 - root - INFO - Sync job completed in 36.88 seconds
2025-03-19 14:34:10,298 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:34:10,298 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:39:10,994 - root - INFO - Starting incremental sync job at 2025-03-19 14:39:10.994873
2025-03-19 14:39:11,715 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:39:11,718 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:39:11,723 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:39:11,724 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:39:18,474 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:39:18,486 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#6940,aadhar#6941,address#6942,companyId#6943,dateOfBirth#6944,email#6945,income#6946,name#6947,pan#6948,personId#6949,phone#6950,position#6951,roles#6952,yearsEmployed#6953] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:39:24,780 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:39:24,803 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#6985,address#6986,companyId#6987,founded#6988,gst_number#6989,name#6990,phone#6991,sector#6992,website#6993] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:39:32,927 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:39:32,944 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#7020,amount#7021,applicationDate#7022,coapplicantId#7023,decisionDate#7024,interestRate#7025,loanId#7026,loanType#7027,primaryApplicantId#7028,references#7029,status#7030,term#7031] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:39:38,478 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:39:38,496 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#7061,isCoApplicantFor#7062,isReferenceFor#7063,loans#7064,name#7065,pan#7066,personId#7067,primaryApplicantId#7068] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:39:44,346 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:39:44,356 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#7094,coApplicantId#7095,linkedTo#7096,loanId#7097,name#7098,pan#7099,personId#7100,relationToPrimary#7101] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:39:50,067 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:39:50,082 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#7127,linkedTo#7128,loanId#7129,name#7130,pan#7131,personId#7132,referenceId#7133,relationToBorrower#7134,yearsKnown#7135] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:39:50,084 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:39:50,084 - src.etl.load - INFO - No Person data to load
2025-03-19 14:39:50,084 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:39:50,084 - src.etl.load - INFO - No Company data to load
2025-03-19 14:39:50,085 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:39:50,085 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:39:50,085 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:39:50,085 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:39:50,085 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:39:50,086 - root - INFO - Sync job completed in 39.09 seconds
2025-03-19 14:39:50,086 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:39:50,086 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:44:51,196 - root - INFO - Starting incremental sync job at 2025-03-19 14:44:51.196824
2025-03-19 14:44:51,935 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:44:51,939 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:44:51,946 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:44:51,947 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:44:58,310 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:44:58,324 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#7162,aadhar#7163,address#7164,companyId#7165,dateOfBirth#7166,email#7167,income#7168,name#7169,pan#7170,personId#7171,phone#7172,position#7173,roles#7174,yearsEmployed#7175] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:45:04,352 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:45:04,370 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#7207,address#7208,companyId#7209,founded#7210,gst_number#7211,name#7212,phone#7213,sector#7214,website#7215] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:45:12,164 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:45:12,189 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#7242,amount#7243,applicationDate#7244,coapplicantId#7245,decisionDate#7246,interestRate#7247,loanId#7248,loanType#7249,primaryApplicantId#7250,references#7251,status#7252,term#7253] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:45:18,014 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:45:18,030 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#7283,isCoApplicantFor#7284,isReferenceFor#7285,loans#7286,name#7287,pan#7288,personId#7289,primaryApplicantId#7290] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:45:23,871 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:45:23,891 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#7316,coApplicantId#7317,linkedTo#7318,loanId#7319,name#7320,pan#7321,personId#7322,relationToPrimary#7323] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:45:29,878 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:45:29,904 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#7349,linkedTo#7350,loanId#7351,name#7352,pan#7353,personId#7354,referenceId#7355,relationToBorrower#7356,yearsKnown#7357] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:45:29,905 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:45:29,906 - src.etl.load - INFO - No Person data to load
2025-03-19 14:45:29,906 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:45:29,906 - src.etl.load - INFO - No Company data to load
2025-03-19 14:45:29,906 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:45:29,906 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:45:29,907 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:45:29,907 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:45:29,907 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:45:29,907 - root - INFO - Sync job completed in 38.71 seconds
2025-03-19 14:45:29,907 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:45:29,907 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:50:30,954 - root - INFO - Starting incremental sync job at 2025-03-19 14:50:30.954940
2025-03-19 14:50:31,794 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:50:31,798 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:50:31,804 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:50:31,804 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:50:38,181 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:50:38,196 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#7384,aadhar#7385,address#7386,companyId#7387,dateOfBirth#7388,email#7389,income#7390,name#7391,pan#7392,personId#7393,phone#7394,position#7395,roles#7396,yearsEmployed#7397] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:50:44,362 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:50:44,373 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#7429,address#7430,companyId#7431,founded#7432,gst_number#7433,name#7434,phone#7435,sector#7436,website#7437] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:50:49,943 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:50:49,964 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#7464,amount#7465,applicationDate#7466,coapplicantId#7467,decisionDate#7468,interestRate#7469,loanId#7470,loanType#7471,primaryApplicantId#7472,references#7473,status#7474,term#7475] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:50:55,983 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 2025-03-18T18:53:45.323152Z
2025-03-19 14:50:55,999 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `loans`, `personId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:45.323152Z)
+- Relation [_id#7505,isCoApplicantFor#7506,isReferenceFor#7507,loans#7508,name#7509,pan#7510,personId#7511,primaryApplicantId#7512] MongoRelation(MongoRDD[69] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(isCoApplicantFor,ArrayType(StringType,true),true),StructField(isReferenceFor,ArrayType(StringType,true),true),StructField(loans,ArrayType(StringType,true),true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(primaryApplicantId,StringType,true))))

2025-03-19 14:51:01,453 - src.etl.extract - INFO - Extracting Coapplicant data modified since 2025-03-18T18:53:54.899035Z
2025-03-19 14:51:01,463 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:53:54.899035Z)
+- Relation [_id#7538,coApplicantId#7539,linkedTo#7540,loanId#7541,name#7542,pan#7543,personId#7544,relationToPrimary#7545] MongoRelation(MongoRDD[92] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(coApplicantId,StringType,true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(relationToPrimary,StringType,true))))

2025-03-19 14:51:07,079 - src.etl.extract - INFO - Extracting Reference data modified since 2025-03-18T18:54:04.557995Z
2025-03-19 14:51:07,100 - src.etl.extract - ERROR - Error extracting collection Reference: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`name`, `pan`, `_id`, `linkedTo`, `loanId`].;
'Filter ('lastUpdated > 2025-03-18T18:54:04.557995Z)
+- Relation [_id#7571,linkedTo#7572,loanId#7573,name#7574,pan#7575,personId#7576,referenceId#7577,relationToBorrower#7578,yearsKnown#7579] MongoRelation(MongoRDD[115] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(linkedTo,StringType,true),StructField(loanId,StringType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(referenceId,StringType,true),StructField(relationToBorrower,StringType,true),StructField(yearsKnown,IntegerType,true))))

2025-03-19 14:51:07,101 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:51:07,102 - src.etl.load - INFO - No Person data to load
2025-03-19 14:51:07,102 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:51:07,102 - src.etl.load - INFO - No Company data to load
2025-03-19 14:51:07,103 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:51:07,103 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:51:07,103 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:51:07,104 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:51:07,104 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:51:07,104 - root - INFO - Sync job completed in 36.15 seconds
2025-03-19 14:51:07,104 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:51:07,104 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:56:08,039 - root - INFO - Starting incremental sync job at 2025-03-19 14:56:08.039004
2025-03-19 14:56:08,819 - src.spark.session - INFO - Spark session created successfully
2025-03-19 14:56:08,823 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 14:56:08,830 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 14:56:08,830 - root - INFO - Extracting data from MongoDB...
2025-03-19 14:56:14,864 - src.etl.extract - INFO - Extracting Person data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:56:14,876 - src.etl.extract - ERROR - Error extracting collection Person: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`aadhar`, `name`, `pan`, `phone`, `_id`].;
'Filter ('lastUpdated > 1970-01-01T00:00:00.000Z)
+- Relation [_id#7606,aadhar#7607,address#7608,companyId#7609,dateOfBirth#7610,email#7611,income#7612,name#7613,pan#7614,personId#7615,phone#7616,position#7617,roles#7618,yearsEmployed#7619] MongoRelation(MongoRDD[0] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(aadhar,StringType,true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(dateOfBirth,StringType,true),StructField(email,StringType,true),StructField(income,IntegerType,true),StructField(name,StringType,true),StructField(pan,StringType,true),StructField(personId,StringType,true),StructField(phone,StringType,true),StructField(position,StringType,true),StructField(roles,StructType(StructField(coApplicant,ArrayType(StringType,true),true),StructField(primaryApplicant,ArrayType(StringType,true),true),StructField(reference,ArrayType(StringType,true),true)),true),StructField(yearsEmployed,IntegerType,true))))

2025-03-19 14:56:20,619 - src.etl.extract - INFO - Extracting Company data modified since 2025-03-18T18:53:34.615993Z
2025-03-19 14:56:20,640 - src.etl.extract - ERROR - Error extracting collection Company: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`founded`, `gst_number`, `name`, `phone`, `website`].;
'Filter ('lastUpdated > 2025-03-18T18:53:34.615993Z)
+- Relation [_id#7651,address#7652,companyId#7653,founded#7654,gst_number#7655,name#7656,phone#7657,sector#7658,website#7659] MongoRelation(MongoRDD[23] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(address,StringType,true),StructField(companyId,StringType,true),StructField(founded,StringType,true),StructField(gst_number,StringType,true),StructField(name,StringType,true),StructField(phone,StringType,true),StructField(sector,StringType,true),StructField(website,StringType,true))))

2025-03-19 14:56:26,340 - src.etl.extract - INFO - Extracting Loan data modified since 2025-03-18T18:53:25.663309Z
2025-03-19 14:56:26,364 - src.etl.extract - ERROR - Error extracting collection Loan: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `lastUpdated` cannot be resolved. Did you mean one of the following? [`status`, `amount`, `loanType`, `_id`, `decisionDate`].;
'Filter ('lastUpdated > 2025-03-18T18:53:25.663309Z)
+- Relation [_id#7686,amount#7687,applicationDate#7688,coapplicantId#7689,decisionDate#7690,interestRate#7691,loanId#7692,loanType#7693,primaryApplicantId#7694,references#7695,status#7696,term#7697] MongoRelation(MongoRDD[46] at RDD at MongoRDD.scala:51,Some(StructType(StructField(_id,StructType(StructField(oid,StringType,true)),true),StructField(amount,IntegerType,true),StructField(applicationDate,TimestampType,true),StructField(coapplicantId,StringType,true),StructField(decisionDate,TimestampType,true),StructField(interestRate,DoubleType,true),StructField(loanId,StringType,true),StructField(loanType,StringType,true),StructField(primaryApplicantId,StringType,true),StructField(references,ArrayType(StringType,true),true),StructField(status,StringType,true),StructField(term,IntegerType,true))))

2025-03-19 14:56:30,821 - py4j.clientserver - INFO - Error while sending or receiving.
Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host
2025-03-19 14:56:30,826 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:30,826 - root - INFO - Exception while sending command.
Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending
2025-03-19 14:56:32,870 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:32,871 - py4j.clientserver - INFO - Error while receiving.
Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:32,879 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:32,880 - root - ERROR - Exception while sending command.
Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\socket.py", line 681, in readinto
    return self._sock.recv_into(b)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 539, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending or receiving
2025-03-19 14:56:32,882 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:32,884 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:34,922 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:34,922 - src.spark.session - WARNING - Could not get last sync timestamp: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:34,922 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:34,922 - src.etl.extract - INFO - Extracting PrimaryApplicant data modified since 1970-01-01T00:00:00.000Z
2025-03-19 14:56:36,969 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:36,970 - src.etl.extract - ERROR - Error extracting collection PrimaryApplicant: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:36,971 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:39,009 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:39,010 - src.etl.extract - ERROR - Error extracting collection Coapplicant: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:39,011 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:41,048 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:41,049 - src.etl.extract - ERROR - Error extracting collection Reference: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:41,049 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:41,050 - root - INFO - Loading nodes into Neo4j...
2025-03-19 14:56:41,050 - src.etl.load - INFO - No Person data to load
2025-03-19 14:56:41,051 - src.etl.load - INFO - No Loan data to load
2025-03-19 14:56:41,051 - src.etl.load - INFO - No Company data to load
2025-03-19 14:56:41,051 - root - INFO - Loading relationships into Neo4j...
2025-03-19 14:56:41,051 - src.etl.load - INFO - No PrimaryApplicant data to load
2025-03-19 14:56:41,052 - src.etl.load - INFO - No CoApplicant data to load
2025-03-19 14:56:41,052 - src.etl.load - INFO - No Reference data to load
2025-03-19 14:56:41,052 - src.etl.load - INFO - No Person data to load Person-Company relationships
2025-03-19 14:56:41,052 - root - INFO - Sync job completed in 33.01 seconds
2025-03-19 14:56:41,052 - root - INFO - Nodes loaded: 0 Persons, 0 Loans, 0 Companies
2025-03-19 14:56:41,052 - root - INFO - Relationships loaded: 0 Primary, 0 CoApplicant, 0 Reference, 0 Company
2025-03-19 14:56:43,068 - py4j.clientserver - INFO - Closing down clientserver connection
2025-03-19 14:56:43,068 - root - ERROR - Error during sync job: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File ".\src\main.py", line 75, in run_sync_job
    spark.stop()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\sql\session.py", line 1796, in stop
    self._sc.stop()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 654, in stop
    self._jsc.stop()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-03-19 14:56:43,071 - py4j.clientserver - INFO - Closing down clientserver connection
