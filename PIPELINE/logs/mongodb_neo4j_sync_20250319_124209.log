2025-03-19 12:42:09,112 - root - INFO - Starting MongoDB to Neo4j sync service
2025-03-19 12:42:09,112 - root - INFO - Sync interval: 5 minutes
2025-03-19 12:42:09,112 - root - INFO - Starting full sync job at 2025-03-19 12:42:09.112317
2025-03-19 12:42:15,202 - src.spark.session - INFO - Spark session created successfully
2025-03-19 12:42:15,315 - src.graph.neo4j_client - INFO - Connected to Neo4j database
2025-03-19 12:42:15,327 - src.graph.neo4j_client - INFO - Neo4j schema initialized
2025-03-19 12:42:15,328 - root - INFO - Extracting data from MongoDB...
2025-03-19 12:42:21,294 - src.etl.extract - INFO - Extracted 50 records from Person
2025-03-19 12:42:22,660 - src.etl.extract - INFO - Extracted 10 records from Company
2025-03-19 12:42:23,842 - src.etl.extract - INFO - Extracted 93 records from Loan
2025-03-19 12:42:24,696 - src.etl.extract - INFO - Extracted 57 records from PrimaryApplicant
2025-03-19 12:42:25,605 - src.etl.extract - INFO - Extracted 93 records from Coapplicant
2025-03-19 12:42:26,850 - src.etl.extract - INFO - Extracted 183 records from Reference
2025-03-19 12:42:26,855 - root - INFO - Loading nodes into Neo4j...
2025-03-19 12:42:31,057 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(0) already exists with label `Person` and property `personId` = 'PERSON001'
2025-03-19 12:42:32,189 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(1) already exists with label `Person` and property `personId` = 'PERSON002'
2025-03-19 12:42:33,281 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(2) already exists with label `Person` and property `personId` = 'PERSON003'
2025-03-19 12:42:34,461 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(3) already exists with label `Person` and property `personId` = 'PERSON004'
2025-03-19 12:42:35,660 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(4) already exists with label `Person` and property `personId` = 'PERSON005'
2025-03-19 12:42:36,797 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(5) already exists with label `Person` and property `personId` = 'PERSON006'
2025-03-19 12:42:37,818 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(6) already exists with label `Person` and property `personId` = 'PERSON007'
2025-03-19 12:42:38,862 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(7) already exists with label `Person` and property `personId` = 'PERSON008'
2025-03-19 12:42:39,861 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(8) already exists with label `Person` and property `personId` = 'PERSON009'
2025-03-19 12:42:40,907 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(9) already exists with label `Person` and property `personId` = 'PERSON010'
2025-03-19 12:42:41,885 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(10) already exists with label `Person` and property `personId` = 'PERSON011'
2025-03-19 12:42:42,950 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(11) already exists with label `Person` and property `personId` = 'PERSON012'
2025-03-19 12:42:43,965 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(12) already exists with label `Person` and property `personId` = 'PERSON013'
2025-03-19 12:42:44,962 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(13) already exists with label `Person` and property `personId` = 'PERSON014'
2025-03-19 12:42:45,893 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(14) already exists with label `Person` and property `personId` = 'PERSON015'
2025-03-19 12:42:46,839 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(15) already exists with label `Person` and property `personId` = 'PERSON016'
2025-03-19 12:42:47,868 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(16) already exists with label `Person` and property `personId` = 'PERSON017'
2025-03-19 12:42:48,877 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(17) already exists with label `Person` and property `personId` = 'PERSON018'
2025-03-19 12:42:49,803 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(18) already exists with label `Person` and property `personId` = 'PERSON019'
2025-03-19 12:42:50,735 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(19) already exists with label `Person` and property `personId` = 'PERSON020'
2025-03-19 12:42:51,683 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(20) already exists with label `Person` and property `personId` = 'PERSON021'
2025-03-19 12:42:52,574 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(21) already exists with label `Person` and property `personId` = 'PERSON022'
2025-03-19 12:42:53,580 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(22) already exists with label `Person` and property `personId` = 'PERSON023'
2025-03-19 12:42:54,532 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(23) already exists with label `Person` and property `personId` = 'PERSON024'
2025-03-19 12:42:55,468 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(24) already exists with label `Person` and property `personId` = 'PERSON025'
2025-03-19 12:42:56,431 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(25) already exists with label `Person` and property `personId` = 'PERSON026'
2025-03-19 12:42:57,392 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(26) already exists with label `Person` and property `personId` = 'PERSON027'
2025-03-19 12:42:58,288 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(27) already exists with label `Person` and property `personId` = 'PERSON028'
2025-03-19 12:42:59,337 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(28) already exists with label `Person` and property `personId` = 'PERSON029'
2025-03-19 12:43:00,305 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(29) already exists with label `Person` and property `personId` = 'PERSON030'
2025-03-19 12:43:01,181 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(30) already exists with label `Person` and property `personId` = 'PERSON031'
2025-03-19 12:43:02,099 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(31) already exists with label `Person` and property `personId` = 'PERSON032'
2025-03-19 12:43:03,046 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(32) already exists with label `Person` and property `personId` = 'PERSON033'
2025-03-19 12:43:03,977 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(33) already exists with label `Person` and property `personId` = 'PERSON034'
2025-03-19 12:43:04,920 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(34) already exists with label `Person` and property `personId` = 'PERSON035'
2025-03-19 12:43:05,823 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(35) already exists with label `Person` and property `personId` = 'PERSON036'
2025-03-19 12:43:06,790 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(36) already exists with label `Person` and property `personId` = 'PERSON037'
2025-03-19 12:43:07,705 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(37) already exists with label `Person` and property `personId` = 'PERSON038'
2025-03-19 12:43:08,622 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(38) already exists with label `Person` and property `personId` = 'PERSON039'
2025-03-19 12:43:09,521 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(39) already exists with label `Person` and property `personId` = 'PERSON040'
2025-03-19 12:43:10,408 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(40) already exists with label `Person` and property `personId` = 'PERSON041'
2025-03-19 12:43:11,336 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(41) already exists with label `Person` and property `personId` = 'PERSON042'
2025-03-19 12:43:12,256 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(42) already exists with label `Person` and property `personId` = 'PERSON043'
2025-03-19 12:43:13,240 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(43) already exists with label `Person` and property `personId` = 'PERSON044'
2025-03-19 12:43:14,207 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(44) already exists with label `Person` and property `personId` = 'PERSON045'
2025-03-19 12:43:15,228 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(45) already exists with label `Person` and property `personId` = 'PERSON046'
2025-03-19 12:43:16,173 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(46) already exists with label `Person` and property `personId` = 'PERSON047'
2025-03-19 12:43:17,078 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(47) already exists with label `Person` and property `personId` = 'PERSON048'
2025-03-19 12:43:18,016 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(48) already exists with label `Person` and property `personId` = 'PERSON049'
2025-03-19 12:43:18,995 - src.graph.neo4j_client - ERROR - Error upserting Person node: [Schema.ConstraintValidationFailed] Node(49) already exists with label `Person` and property `personId` = 'PERSON050'
2025-03-19 12:43:18,996 - src.etl.load - INFO - Loaded 0 Person nodes
2025-03-19 12:43:20,800 - src.etl.load - INFO - Loaded 93 Loan nodes
2025-03-19 12:43:26,843 - src.spark.session - INFO - Updated sync timestamp for Loan to 2025-03-19T07:13:20.801062Z
2025-03-19 12:43:27,765 - src.etl.load - INFO - Loaded 10 Company nodes
2025-03-19 12:43:33,453 - src.spark.session - INFO - Updated sync timestamp for Company to 2025-03-19T07:13:27.765637Z
2025-03-19 12:43:33,454 - root - INFO - Loading relationships into Neo4j...
2025-03-19 12:43:39,117 - src.etl.load - INFO - Created 93 PrimaryApplicant-Loan relationships
2025-03-19 12:43:44,547 - src.spark.session - INFO - Updated sync timestamp for PrimaryApplicant to 2025-03-19T07:13:39.117681Z
2025-03-19 12:43:49,164 - src.etl.load - INFO - Created 93 Loan-CoApplicant relationships
2025-03-19 12:43:54,976 - src.spark.session - INFO - Updated sync timestamp for Coapplicant to 2025-03-19T07:13:49.165232Z
2025-03-19 12:43:59,164 - src.etl.load - INFO - Created 183 Loan-Reference relationships
2025-03-19 12:44:04,456 - src.spark.session - INFO - Updated sync timestamp for Reference to 2025-03-19T07:13:59.165764Z
2025-03-19 12:44:06,779 - src.etl.load - INFO - Created 50 Person-Company relationships
2025-03-19 12:44:06,780 - root - INFO - Sync job completed in 117.67 seconds
2025-03-19 12:44:06,781 - root - INFO - Nodes loaded: 0 Persons, 93 Loans, 10 Companies
2025-03-19 12:44:06,781 - root - INFO - Relationships loaded: 93 Primary, 93 CoApplicant, 183 Reference, 50 Company
2025-03-19 12:47:24,398 - root - ERROR - Service stopped due to error: 'NoneType' object has no attribute 'sc'
Traceback (most recent call last):
  File ".\src\main.py", line 97, in main
    time.sleep(1)
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "C:\Users\ADITI\anaconda3\envs\spark_env\lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
AttributeError: 'NoneType' object has no attribute 'sc'
